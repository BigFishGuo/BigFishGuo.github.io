<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>8</title>
    <script src="../js/vue.js"></script>
    <script src="../js/vue-router.js"></script>
</head>

<body>
    <div id="app">
        <h1>Redirect</h1>
        <ul>
            <li>
                <router-link to="/relative-redirect">
                    /relative-redirect (redirects to /foo)
                </router-link>
            </li>
            <li>
                <router-link to="/relative-redirect?foo=bar">
                    /relative-redirect?foo=bar (redirects to /foo?foo=bar)
                </router-link>
            </li>
            <li>
                <router-link to="/absolute-redirect">
                    /absolute-redirect (redirects to /bar)
                </router-link>
            </li>
            <li>
                <router-link to="/dynamic-redirect">
                    /dynamic-redirect (redirects to /bar)
                </router-link>
            </li>
            <li>
                <router-link to="/dynamic-redirect/123">
                    /dynamic-redirect/123 (redirects to /with-params/123)
                </router-link>
            </li>
            <li>
                <router-link to="/dynamic-redirect?to=foo">
                    /dynamic-redirect?to=foo (redirects to /foo)
                </router-link>
            </li>
            <li>
                <router-link to="/dynamic-redirect#bar">
                    /dynamic-redirect#bar (redirects to /bar)
                </router-link>
            </li>
            <li>
                <router-link to="/redirect-with-params/123">
                    /redirect-with-params/123 (redirects to /with-params/123)
                </router-link>
            </li>
            <li>
                <router-link to="/not-found">
                    /not-found (redirects to /)
                </router-link>
            </li>
        </ul>
        <router-view class="view"></router-view>
    </div>
    <script>
        const Home = {
            template: `<router-view></router-view>`
        }
        const Default = {
            template: `<h2>default</h2>`
        }
        const Foo = {
            template: `<h2>foo</h2>`
        }
        const Bar = {
            template: `<h2>bar</h2>`
        }
        const WithParams = {
            template: `<h2>{{$route.params.id}}</h2>`
        }


        const router = new VueRouter({
            mode: "history",
            routes: [
                {
                    path: "/",
                    component: Home,
                    children: [
                        {
                            path: "",
                            component: Default
                        },
                        {
                            path: "foo",
                            component: Foo
                        },
                        {
                            path: "bar",
                            component: Bar
                        },
                        {
                            path: "with-params/:id",
                            component: WithParams
                        },
                        {
                            path: "relative-redirect",
                            redirect: "foo"
                        }
                    ]
                },
                {
                    path: "/absolute-redirect",
                    redirect: "/bar"
                },
                {
                    path: "/dynamic-redirect/:id?",
                    redirect: to => {
                        const {hash, params, query} = to;
                        console.log(to);
                        if(query.to == "foo") {
                            return {
                                path: "/foo",
                                query: null
                            }
                        }

                        if(hash === "#bar") {
                            return {
                                path: "/bar",
                                hash: ""
                            }
                        }

                        if(params.id) {
                            return {
                                path: "/with-params/:id"
                            }
                        }else {
                            return "/bar"
                        }
                    }
                },
                {
                    path: "/redirect-with-params/:id",
                    redirect: "/with-params/:id"
                },
                {
                    path: "*",
                    redirect: "/"
                }
            ]
        })

        new Vue({
            router: router
        }).$mount("#app")
    </script>
</body>

</html>
